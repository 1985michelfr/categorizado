{% extends "base.html" %} {% block title %}Dashboard{% endblock %} {% block
content %}
<div class="container-fluid">
  <!-- Stats Row -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card stat-card">
        <div class="stat-label">Total de Gastos (Mês Atual)</div>
        <div class="stat-value">
          R$ {{ total_mes_atual|default('0.00') }}
          <small class="trend-up ms-2">+14.8%</small>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card stat-card">
        <div class="stat-label">Categorias</div>
        <div class="stat-value">{{ categorias|length }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card stat-card">
        <div class="stat-label">Estabelecimentos</div>
        <div class="stat-value">{{ estabelecimentos|length }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card stat-card">
        <div class="stat-label">Transações</div>
        <div class="stat-value">{{ transacoes|length }}</div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row">
    <div class="col-md-8">
      <div class="card chart-container">
        <h5 class="card-title mb-4">Gastos por Mês</h5>
        <canvas id="gastosChart"></canvas>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card chart-container">
        <h5 class="card-title mb-4">Distribuição por Categoria</h5>
        <canvas id="categoriasChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Actions Row -->
  <div class="row mt-4">
    <div class="col-md-6">
      <div class="card p-4">
        <h5 class="card-title">Upload de Arquivo</h5>
        <form
          method="POST"
          action="{{ url_for('upload_file') }}"
          enctype="multipart/form-data"
        >
          <div class="mb-3">
            <input type="file" class="form-control" name="file" />
          </div>
          <button type="submit" class="btn btn-primary">Enviar</button>
        </form>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card p-4">
        <h5 class="card-title">Nova Categoria</h5>
        <form method="POST" action="{{ url_for('adicionar_categoria') }}">
          <div class="mb-3">
            <input
              type="text"
              class="form-control"
              name="nome"
              placeholder="Nome da categoria"
            />
          </div>
          <button type="submit" class="btn btn-primary">Adicionar</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  // Gráfico de Gastos por Mês
  const ctx = document.getElementById("gastosChart").getContext("2d");
  new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun"],
      datasets: [
        {
          label: "Gastos Mensais",
          data: [12000, 19000, 15000, 17000, 14000, 18000],
          backgroundColor: "rgba(136, 51, 255, 0.5)",
          borderColor: "rgba(136, 51, 255, 1)",
          borderWidth: 1,
        },
      ],
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          grid: {
            color: "rgba(255, 255, 255, 0.1)",
          },
        },
        x: {
          grid: {
            display: false,
          },
        },
      },
    },
  });

  // Gráfico de Categorias
  const ctxPie = document.getElementById("categoriasChart").getContext("2d");
  new Chart(ctxPie, {
    type: "doughnut",
    data: {
      labels: ["Alimentação", "Transporte", "Lazer", "Outros"],
      datasets: [
        {
          data: [30, 20, 25, 25],
          backgroundColor: ["#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0"],
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "right",
        },
      },
    },
  });
</script>
{% endblock %}
